[
["index.html", "Pathways CBW workshop 1 Welcome 1.1 Workshop Schedule 1.2 Pre-Workshop Materials and Laptop Setup Instructions", " Pathways CBW workshop Gary Bader, Veronique Voisin, Ruth Isserlin, Lincoln Stein, Robin Haw, Micheal Hoffman, Quaid Morris last modified 2020-07-15 1 Welcome Welcome to Pathways and Network Analysis of -Omics Data 2020. Meet your faculty here. CLASS MATERIALS: You can download the printed course manual here. 1.1 Workshop Schedule Day 1 Day 2 Day 3 Monday July, 27 Tuesday, July 28 Wednesday, July 29 8:30 Registration and Breakfast 8:30 Breakfast 8:30 Breakfast 9:00 Welcome (Michelle Brazas) 9:30 Module 1: Introduction to Pathway and Network Analysis (Gary Bader) 9:00 Module 4: More Depth on Network and Pathway Analysis (Robin Haw) 9:00 Module 6: Regulatory Network Analysis (Michael Hoffman) 11:00 Coffee Break 10:00 Coffee Break 10:30 Coffee Break 11:30 Module 2: Finding Over-Represented Pathways (Veronique Voisin) 10:30 Module 4 Lab (Robin) 11:00 Module 6 Lab (Veronique) 12:30 Lunch 12:30 Lunch 12:30 Survey and Closing Remarks 1:30 Module 2 Lab (Veronique Voisin) 1:30 Module 5: Gene Function Prediction (Quaid Morris) 1:00 Integrated Assignment 3:00 Coffee Break 3:00 Coffee Break 3:30 Module 3: Network Visualization and Analysis with Cytoscape (Gary Bader) 3:30 Module 5 Lab (Veronique Voisin) 4:15 Module 3 Lab (Veronique Voisin) 5:00 Dinner 5:00 Dinner 1.2 Pre-Workshop Materials and Laptop Setup Instructions 1.2.1 Laptop Setup Instructions Instructions to setup your laptop can be found ## Install these tools on your laptop before coming to the workshop: A robust text editor. For Windows/PC - notepad++ For Linux - gEdit For Mac – TextWrangler A file decompression tool. For Windows/PC – 7zip. For Linux – gzip. For Mac – already there. A robust internet browser such as Firefox or Safari (Internet Explorer and Chrome are not recommended because of Java issues). Java -The software that we will be using (GSEA and Cytoscape) requires Java. Check if you have Java installed: https://www.java.com/verify/ and download Java if you do not have it installed. You need Java 8. Do NOT install Java 10. A PDF viewer (Adobe Acrobat or equivalent). Install Cytoscape 3.7.1. Choose the version corresponding to your operating system (OS, Windows or UNIX) Cytoscape requires Java8: check your version at https://www.java.com/verify/ and download Java8 if you do not have it installed. Contact your system administrator if you have trouble with Java installation. Within the Cytoscape program, install the following Cytoscape apps. From the menu bar, select ‘Apps’, then ‘App Manager’. Within ‘all apps’, search for the following and install: EnrichmentMap 3.2.0 EnrichmentMap Pipeline Collection 1.0.0 (it will install ClusterMaker2, WordCloud and AutoAnnotate) GeneMANIA 3.5.1 IRegulon 1.3 ReactomeFIPlugin 7.2.0 - http://apps.cytoscape.org/apps/reactomefiplugin stringApp 1.4.2 yFiles Layout Algorithms 1.0.2 Install the data set within GeneMANIA app. From the menu bar, select ‘Apps’, hover over ‘GeneMANIA’, then select ‘Choose Another Data Set’. From the list of available data sets, select the most recent (2017-07-13/13 July 2017) and under ‘Include only these networks:’ select ‘all’. Click on ‘Download’. An ‘Install Data’ window will pop-up. Select H.Sapiens Human (2589 MB). Click on ‘Install’. This requires time and a good network connection to download completely, so be patient (around 15mins). Install GSEA. Go to the GSEA page Register Login option 1 recommended: In menu, in the javaGSEA Desktop Application section, changed Launch with&quot; to 4GBG (for 64 bit Java only)* Click on the Launch button. This is downloading a gsea icon. Save it on your computer. Double click on this icon to open GSEA. Note 1: please try to lauch GSEA before the workshop (open). Note 2: Most common issue with GSEA during the workshop is out of memory error because GSEA was launched with 1GB instead of 4 GB. Please make sure that you have downloaded the 4GB start icon as descrived above. ** option 2 in case option 1 does not work on your computer:** In menu, choose Downloads Go to the javaGSEA Java Jar file section and download the gsea-3.0.jar file and save in your Documents folder (do not leave it in the “Downloads”folder). MAC/Linux Computer On a MAC, the Terminal window is located in Applications/Utilities. Tip: add the terminal window to your dock so it is easy to open when needed. At the prompt, type the command in your terminal window and hit enter: java -Xmx4G -jar ~/Documents/gsea-3.0.jar PC/Windows Computer On Windows, go to the start icon and type cmd (for command prompt) in the search box. At the prompt, type the following commands, hitting enter in between each command and waiting for the prompt before the next command: cd Documents java -Xmx4G -jar gsea-3.0.jar 1.2.2 Pre-workshop Tutorials It is in your best interest to complete these before the workshop. 1.2.2.1 Read the following papers before coming to the workshop: Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Reimand J, Isserlin R, Voisin V, Kucera M, Tannus-Lopes C, Rostamianfar A, Wadi L, Meyer M, Wong J, Xu C, Merico D, Bader GD Nat Protoc. 2019 Feb;14(2):482-517 - Available here as well iRegulon: from a gene list to a gene regulatory network using large motif and track collectionsJanky R, Verfaillie A, Imrichová H, Van de Sande B, Standaert L, Christiaens V, Hulselmans G, Herten K, Naval Sanchez M, Potier D, Svetlichnyy D, Kalender Atak Z, Fiers M, Marine JC, Aerts SPLoS Comput Biol. 2014 Jul 24;10(7) The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function Warde-Farley D, Donaldson SL, Comes O, Zuberi K, Badrawi R, Chao P, Franz M, Grouios C, Kazi F, Lopes CT, Maitland A, Mostafavi S, Montojo J, Shao Q, Wright G, Bader GD, Morris Q Nucleic Acids Res 2010 Jul 1;38 Suppl:W214-20 - Available here as well GeneMANIA update 2018Franz M, Rodriguez H, Lopes C, Zuberi K, Montojo J, Bader GD, Morris Q Nucleic Acids Res. 2018 Jun 15 - Available here as well How to visually interpret biological data using networks Merico D, Gfeller D, Bader GD Nature Biotechnology 2009 Oct 27, 921-924 - Available here as well g:Profiler–a web-based toolset for functional profiling of gene lists from large-scale experiments.Reimand J, Kull M, Peterson H, Hansen J, Vilo J Nucleic Acids Res. 2007 Jul;35 g:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update)Raudvere U, Kolberg L, Kuzmin I, Arak T, Adler P, Peterson H, Vilo JNucleic Acids Res. 2019 May 8 Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profilesSubramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, Paulovich A, Pomeroy SL, Golub TR, Lander ES, Mesirov JPProc Natl Acad Sci U S A. 2005 Oct 25;102(43) Expression data analysis with ReactomeJupe S, Fabregat A, Hermjakob HCurr Protoc Bioinformatics. 2015 Mar 9;49:8.20.1-9 1.2.2.2 Do these exercises before coming to the workshop: Sequencing Terminology Cytoscape Preparation tutorials: From introductory tutorial to Cytoscape, complete: Tour of Cytoscape Basic Data Visualization 1.2.3 Additional tutorials EnrichmentMap (GSEA and g:Profiler) step by step protocol: https://www.biorxiv.org/content/early/2017/12/12/232835 and https://github.com/BaderLab/Cytoscape_workflows Interacting with Cytoscape using CyRest and command lines (for advanced users): https://github.com/cytoscape/cytoscape-automation/blob/master/for-scripters/R/advanced-cancer-networks-and-data-rcy3.Rmd Thank you for attending the Pathway and Network Analysis of Omics Data workshop! Help us make this workshop better by filling out our survey. Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0. "],
["module-1-introduction-to-pathway-and-network-analysis-gary-bader.html", "2 Module 1 - Introduction to Pathway and Network Analysis (Gary Bader)", " 2 Module 1 - Introduction to Pathway and Network Analysis (Gary Bader) "],
["module-2-finding-over-represented-pathways-veronique-voisin.html", "3 Module 2: Finding Over-represented Pathways (Veronique Voisin)", " 3 Module 2: Finding Over-represented Pathways (Veronique Voisin) Veronique Voisin Lecture Introduction to practical lab Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],
["gprofiler-lab.html", "4 Module 2 lab - g:Profiler 4.1 Introduction 4.2 Goal of the exercise 1 4.3 Data 4.4 Exercise 1 - run g:Profiler 4.5 Exercise 2: Load and use a custom .gmt file and run the query 4.6 Optional steps", " 4 Module 2 lab - g:Profiler This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. 4.1 Introduction Performing Over-representation analysis (ORA) with g:Profiler. The practical lab contains 2 exercises. The first exercises uses g:Profiler to perform gene-set enrichment analysis and the second exercises uses enrichr. 4.2 Goal of the exercise 1 Learn how to run g:GOSt Functional profiling from the g:Profiler website and explore the results. 4.3 Data g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types6. The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in Kandoth C. et al. ) (https://www.nature.com/articles/nature12634). Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). 4.4 Exercise 1 - run g:Profiler For this exercise, our goal is to copy and paste the list of genes into g:Profiler, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. g:Profiler performs a gene-set enrichment analysis using a hypergeometric test (Fisher’s exact test) with the option to consider the ranking of the genes in the calculation of the enrichment significance (minimum hypergeometric test). The Gene Ontology Biological Process and Reactome are going to be selected as pathway databases. The results are displayed as a table or downloadable as an EnrichmentMap type output (GEM). Before starting this exercise, download the required files: Supplementary_Tabe1_Cancer_drivers.txt We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. 4.4.1 Step 1 - Launch g:Profiler. Open the g:Profiler website at g:Profiler in your web browser. 4.4.2 Step 2 - input query Paste the gene list (Supplementary_Table1_Cancer_drivers.txt) into the Query field in top-left corner of the screen. The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. 4.4.3 Step 3 - Adjust parameters. 3a. Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to “Benjamini-Hochberg FDR” User threshold - select 0.05 if you want g:Profiler to return only pathways that are significant (FDR &lt; 0.05). if g:Profiler does not return any results increase the threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. 3b. Click on the Data sources tab (black rectangle) to expand it. UnSelect the following gene-set databases by clicking the “clear all” button. * In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. No electronic GO annotations option will discard less reliable GO annotations (IEAs) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. In the biological pathways category, check Reactome. 4.4.4 Step 4 - Run query Click on the Run query button to run g:Profiler. Scroll down page to see results. If after clicking on Run query button the analysis completes but there is the following message above results file - Select the Ensembl ID with the most GO annotations (all). For each ambiguous gene select its correct mapping. Ambiguous mapping is often caused by multiple ensembl ids for a given gene and are easy to resolve as a user. Rerun query. 4.4.5 Step 5 - Explore the results. Step5a: After the query has run, the results are displayed at the bottom of the page, below the input parameters. By default, the “Results” tab is selected. A global graph displays gene-sets that passed the significance threshold of 0.05 for the 2 gene-set databases that we have selected GO Biological Process “GO:BP” and Reactome “REAC”. Numbers in parentheses are indicating the number of gene-sets that passed the threshold. Step5b: Click on “Detailed Results” to view the results in more depth. Two tables are displayed, one for each of the data sources selected. (If more than 2 data sources are selected there will be additional tables for each datasource) Each row of the table contains: Term name - gene-set name Term ID - gene-est identifier Padj - FDR value -log10(Padj) - enrichment score calculated using the formula -log10(padj) variable number of gene columns (One for each gene in the query set) - If the gene is present in the current gene-set its cell is colored. For any data source besides GO the cell is colored black if the gene is found in the gene-set. For the GO data source cells are colored according to the annotation evidence code. Expand the legend tab for detailed coloring mapping of GO evidence codes. The first table displays the gene-sets significantly enriched at FDR 0.05 for the GO:BP database. The second table displays the results corresponding to the Reactome database. 4.4.6 Step 6: Expand the stats tab Expand the stats tab by clicking on the double arrow located at the right of the tab. It displays the gene set size (T), the size of our gene list (Q) , the number of genes that overlap between our gene list and the tested gene-set (TnQ) as well as the number of genes in the background (U). Above the GO:BP result table, locate the slide bar that enables to select for the minimum and maximum number of genes in the tested gene-sets (Term size). Change the maximum Term size from 10000 to 1000 and observe the results in the detailed stats panel: Without filtering term size, the top terms were GO terms containing that could contain 4000 or 5000 genes and that were located high in the GO hierarchy (parent term). With filtering the maximum term size to 1000, the top list contains pathways of larger interpretative values. However, please note that the adjusted pvalues was calculated using all gene-sets without size filtering. 4.4.7 Step 7: Save the results 7a. In the Detailed Results panel, select “GEM” . It will save the results in a text file in the “Generic Enrichment Map” format that we will use to visualize using Cytoscape. select max term size to 10000 ( = no filtering by gene-set size) and click on the GEM button. A file is downloaded on your computer. &lt;img src=&quot;./Module2/gprofiler/images/gp13.png&quot; alt=&quot;workflow&quot; width=&quot;75%&quot; /&gt; select max term size to 1000 ( = filter by gene-set size) and click on the GEM button. A file is downloaded on your computer. 7b: Open one file that you saved using Microsoft Office Excel or in an equivalent software. Observe the results included in this file: Name of each gene-set Description of each gene-set significance of the overlap (pvalue) significance of the overlap (adjusted pvalue/qvalue) Phenotype Genes included in each gene-set :question: Question: Which term has the best corrected p-value? Which genes in our list are included in this term? Observe that same genes can be present in several lines (pathways are related when they contain a lof of genes in common). The table is formatted for the input into Cytoscape EnrichmentMap. It is called the generic format. The p-value and FDR columns contain identical values because g:Profiler directly outputs the FDR (= corrected p-value) meaning that the p-value column is already the FDR. Phenotype 1 means that each pathway will be represented by red nodes on the enrichment map (presented during next module). The term positive regulation of activin receptor signaling pathway is the most significant gene-set (=the lowest FDR value). Many gene-sets from the top of this list are related to each other and have genes in common. 4.4.8 Step 8 8a. Optional but recommended: Download the pathway database files. * Go to the top of the page and expand the “Data sources” tab. Click on the ‘name.gmt’ link located at bottom of this tab. It will download a zipped folder named gprofiler_hsapiens.name.zip containing several pathway database gmt files. 8b: concatenate the GO:BP and Reactome gmt files: option 1: manually if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file and save it as hsapiens.pathways.name.gmt . option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. 4.5 Exercise 2: Load and use a custom .gmt file and run the query For this exercise, our goal is to copy and paste the list of genes into g:Profiler, upload a custom gmt file, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. Uploading a custom gmt file enables us to use alternate pathway data sources not available in g:Profiler. We are going to use a gmt file that contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format downloaded from http://baderlab.org/GeneSets and updated monthly. This file contains pathways from eight data sources: GO, Reactome, Panther, NetPath, NCI, MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG), MSigDB Hallmark (H collection) and HumanCyc. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. This file has been filtered to exlclude gene-sets that contained more than 250 genes as these gene-sets are associated with more general terms. Before starting this exercise, download the required files: Supplementary_Table1_Cancer_drivers.txt. Baderlab_genesets.gmt. We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. STEPS: Repeat step 1 to 3a from Exercise 1 (go back to exercise 1 to get detailed instructions) Briefly: Step 1: Open g:profiler Step 2a : Copy and paste the gene list in the Query field Step 2b: Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to “Benjamini-Hochberg FDR”. Step 3a: Click on the Data sources tab (black rectangle) to expand it. Unselect all choices by clicking the “clear all” button. Step 4: Click on the Custom GMT tab (black rectangle) to expand it. Drag in the box the Baderlab gmt file Baderlab_genesets.gmt. Once uploaded successfully, the name of the file is displayed in the “File name used” box. Step 5: Click on Run query . Step 6: Explore the detailed results Step 7: Save the file as GEM 4.6 Optional steps Please follow these optional steps if time permits and/or to explore more g:Profiler parameters. Here below are 3 optional steps that cover several options offered by g:Profiler: 1. test different data sources, 1. take the order of the gene list into account, 1. use different types of multiple hypothesis correction methods. Use the same gene list as used in exercise 1 and modify paramters listed above. Observe the results. 4.6.1 Optional 1: If time permits, play with input parameters, e.g. add TRANSFAC and miRTarBase databases, rerun the query and explore the new results. Transfac putative transcription factor binding sites (TFBSs) from TRANSFAC database are retrieved into g:GOSt through a special prediction pipeline. First, TFBSs are found by matching TRANSFAC position specific matrices using the program Match on range +/-1kb from TSS as provided by APPRIS (Annotating principal splice isoforms) via Ensembl biomart. For genes with multiple primary TSS annotations we selected one with most TF matches. The matching range for C. elegans, D. melanogaster and S. cerevisiae is 1kb upstream from ATG (translation start site). A cut-off value to minimize the number of false positive matches (provided by TRANSFAC) is then applied to remove spurious motifs. Remaining matches are split into two inclusive groups based on the amount of matches, i.e TFBSs that have at least 1 match are classified as match class 0 and TFBSs that have at least 2 matches per gene are classified as match class 1. mirTarBase is a database that holds experimentally validated information about genes that are targetted by miRNAs. We include all the organisms that are covered by mirTarBase. 4.6.2 Option 2: Re-run the g:Profiler using the ordered query checked. This will run the minimum hypergeometric test. g:Profiler then performs incremental enrichment analysis with increasingly larger numbers of genes starting from the top of the list. When this option is checked, it assumes that the genes were preordered by significance with the most significant gene at the top of the list. Compare the results between “ordered” and non ordered query. for this practical lab, the genes were ordered by the number of mutations found in these genes for all samples. For example, TP53, a highly mutated genes is listed at the top. 4.6.3 Option 3 : Re-run g:Profiler and select g:SCS or Bonferonni as method to correct for multiple hypothesis testing. Do you get any significant results? you can get detailed information about these methods at https://biit.cs.ut.ee/gprofiler/page/docs in the section Significance threshold. Instead of using the g:Profiler website g:profiler can be run directly from R or python see g:Profiler document for more info at https://biit.cs.ut.ee/gprofiler/page/r "],
["gsea-lab.html", "5 Module 2 lab - GSEA 5.1 Introduction 5.2 Goal of the exercise 5.3 Data 5.4 Background 5.5 Additional information", " 5 Module 2 lab - GSEA by Veronique Voisin 5.1 Introduction This practical lab contains one exercise. It uses GSEA to perform a gene-set enrichment analysis. 5.2 Goal of the exercise Learn how to run GSEA and explore the results. 5.3 Data The data used in this exercise is gene expression (transcriptomics) obtained from high-throughput RNA sequencing of Ovarian Serous Cystadenocarcinoma samples. This cohort was previously stratified into four distinct expression subtypes PMID:21720365 and a subset of the immunoreactive and mesenchymal subtypes are compared to demonstrate the GSEA workflow. 5.3.0.1 How was the data processed? Gene expression from the TCGA Ovarian serous cystadenocarcinoma RNASeq V2 cohort was downloaded on 2015-05-22 from cBioPortal for Cancer Genomics. Differential expression for all genes between the mesenchymal and immunoreactive groups was estimated using edgeR. The R code used to generate the data and the rank file used in GSEA is included at the bottom of the document in the Additional information section. 5.4 Background The goal of this lab is to: * upload the 2 required files into GSEA, * adjust relevant parameters, * run GSEA, * open and explore the gene-set enrichment results. The 2 required files are: 1. a rank file (.rnk) 1. a pathway definition file (.gmt). 5.4.0.1 Rank File To generate a rank file (.rnk), a score (-log10(pvalue) * sign(logFC)) was calculated from the edgeR differential expression results. A gene that is significantly differentially expressed(i.e associated with a very small pvalue, close to 0) will be assigned a high score. The sign of the logFC indicates if the gene has an expression which is higher in mesenchymal (logFC &gt; 0, the score will have a + sign) or lower in mesenchymal (logFC &lt; 0, the score will have a - sign). It is used to rank the genes from top up-regulated to top down-regulated (all genes have to be included). Tip: how to generate a rank file. :exclamation: The rank file is going to be provided for the lab, you don’t need to generate it. Calculation of the score Generation of the rank file: select the gene names and score columns and save the file as tab delimited with the extension .rnk 5.4.0.2 Pathway defintion file The second file that is needed for GSEA is the pathway database, a file with the .gmt extension. The pathway database (.gmt) used for the GSEA analysis was downloaded from http://baderlab.org/GeneSets. This file contains gene-sets obtained from MsigDB-c2, NCI, Biocarta, IOB, Netpath, HumanCyc, Reactome and the Gene Ontology (GO) databases. :exclamation: You don’t need to perform this step for the exercise, the .gmt file will be given to you. &lt;img src=&quot;./Module2/gsea/images/saving_gmt.png&quot; alt=&quot;saving_gmt&quot; width=&quot;70%&quot; /&gt; &lt;/p&gt; The .gmt is a tab delimited text file which contains one gene-set per row. For each gene-set (row), the first 2 columns contain the name and the description of the gene-set and the remaining columns contain the list of genes included in the gene-set. It is possible to create a custom gene-set using Excel or R. &lt;img src=&quot;./Module2/gsea/images/gmt_format.png&quot; alt=&quot;get_gmt&quot; width=&quot;70%&quot; /&gt; &lt;/p&gt; GSEA performs a gene-set enrichment analysis using a modified Kolmogorov-Smirnov statistic. The output result consists of summary tables displaying enrichment statistics for each gene-set (pathway) that has been tested. 5.4.1 Start the exercise Before starting this exercise, download the 2 required files: Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt MesenchymalvsImmunoreactive_edger_ranks.rnk 5.4.2 Step1. Launch GSEA. Note regarding option 2: GSEA has been updated to version 3.0: if you still have the gsea_2.2 version, download the .jar file named gsea-3.0.jar from the GSEA Broad website (http://software.broadinstitute.org/gsea/downloads.jsp), open a terminal window and run this command: java -Xmx4G -jar gsea-3.0.jar 5.4.3 Step 2. Load Data 2a. Locate the ‘Load data’ icon at the upper left corner of the window and click on it. 2b. In the central panel, select ‘Method 1’ and ‘Browse for files’. A new window pops up. 2c. Browse your computer to locate the 2 files : Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt and MesenchymalvsImmunoreactive_edger_ranks.rnk. 2d. Click on Choose. A message pops us when the files are loaded successfully. &lt;img src=&quot;./Module2/gsea/images/ORA4.png&quot; alt=&quot;Locate files&quot; width=&quot;50%&quot; /&gt; &lt;/p&gt; 2e. Click on OK. &lt;img src=&quot;./Module2/gsea/images/ORA5.png&quot; alt=&quot;Success&quot; width=&quot;50%&quot; /&gt; &lt;/p&gt; Alternatively, you can choose Method 3 to drag and drop files here; you need to click on the Load these files! button in this case. 5.4.4 Step3. Adjust parameters 3a. Under the Tools menu select GseaPreRanked. 3b. Run GSEA on a Pre-Ranked gene list tab will appear. Specify the following parameters: 3c. Gene sets database - * click on the radio button (…) located at the right of the blank field. * :clock10: Wait 5-10sec for the gene-set selection window to appear. Use the right arrow in the top field to see the Gene matrix (local gmx/gmt) tab. Click to highlight Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt. click on OK at the bottom of the window. &lt;img src=&quot;./Module2/gsea/images/ORA8.png&quot; alt=&quot;Gene sets database&quot; width=&quot;75%&quot; /&gt; Human_GOBP_AllPathways_no_GO_iea_December_24_2016_symbol.gmt is now visible in the field corresponding to Gene sets database. 3d. Number of permutations - 100. The number of permutations is the number of times that the gene-sets will be randomized in order to create a null distribution to calculate the FDR. :exclamation: Use 2000 when you do it for your own data outside the workshop. 3e. Ranked list - select by clicking on the arrow and highlighting rank file. 3f. Click on Show button next to Basic Fields to display extra options. 3g. Analysis name – change default my_analysis to name specific to analysis for example Mesen_vs_Immuno_edgeR. GSEA will use your specified name as part of the name of the results directory it creates. 3h. Save results in this folder – navigate to where you want GSEA to put the results folder. By default GSEA will put the results into the directory gsea_home/output/[date] in your home directory. 3i. Min size: exclude smaller sets – By default GSEA sets the lower limit to 15. In this protocol, the minimum is set to 10 to increase some of the smaller sets in the results. set Enrichment Statistics to p1 if you want to add more weight on the most top up-regulated and top down-regulated. P1 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. 5.4.5 Step 4. Run GSEA 4a. Click on Run button located at the bottom right corner of the window. Expand the window size if the run button is not visible 4b. On the panel located on the left side of the GSEA window, the bottom panel called the GSEA report table will show that it has created a process with a message that it is Running. &lt;img src=&quot;./Module2/gsea/images/ORA10.png&quot; alt=&quot;Running&quot; width=&quot;50%&quot; /&gt; &lt;img src=&quot;./Module2/gsea/images/ORA11.png&quot; alt=&quot;Running messages&quot; width=&quot;75%&quot; /&gt; &lt;/p&gt; On completion the status message will be updated to Success…. &lt;img src=&quot;./Module2/gsea/images/ORA12.png&quot; alt=&quot;Success&quot; width=&quot;50%&quot; /&gt; &lt;/p&gt; There is no progress bar to indicate to the user how much time is left to complete the process. Depending on the size of your dataset and compute power a GSEA run can take from a few minutes to a few hours. To check on the status of the GSEA run in the bottom left hand corner you can click on the + (red circle in below Figure) to see the updating status. Printouts in the format shuffleGeneSet for GeneSet 5816/5821 nperm: 1000 indicate how many permutations have been done (5816) out of the total that need to be performed (5821). if the permutations have been completed but the status is still running, it means that GSEA is creating the report TROUBLESHOOTING: Java Heap Space error. If GSEA returns an error Java Heap space it means that GSEA has run out of memory. If you are running GSEA from the webstart other than the 4GB option then you will need to download a new version that allows for more memory allocation. The current maximum memory allocation that the GSEA webstart allows for is 4GB. If you are using this version and still receive the java heap error you will need to download the GSEA java jar file and launch it from the command line as described in step 1. 5.4.6 Step 5. Examining the results 5a. Click on Success to launch the results in html format in your default web browser. If the GSEA application has been closed, you can still see the results by opening the result folder and clicking on the index file – index.html. (see screenshot below). The first phenotype corresponds to gene-sets enriched in genes up-regulated in the mesenchymal subtype. The second phenotype corresponds to gene-sets enriched in genes up-regulated in the immunological phenotype. &lt;img src=&quot;./Module2/gsea/images/ORA13.png&quot; alt=&quot;Results1&quot; width=&quot;75%&quot; /&gt; &lt;/p&gt; When examining the results there are a few things to look for: 5b. Check the number of gene-sets that have been used for the analysis. A small number (a few hundred genesets if using baderlab genesets) could indicate an issue with identifier mapping. 5c. Check the number of sets that have FDR less than 0.25 – in order to determine what thresholds to start with when creating the enrichment map. It is not uncommon to see a thousand gene sets pass the threshold of FDR less than 0.25. FDR less than 0.25 is a very lax threshold and for robust data we can set thresholds of FDR less than 0.05 or lower. 5d. Click on Snapshots to see the trend for the top 20 genesets. For the positive phenotype the top genesets should show a distribution skewed to the left (positive) i.e. genesets have predominance of up-regulated genes. For the negative phenotype the top geneset should be inverted and skewed to the right (negative) i.e. geneset have predominance of down-regulated genes. 5e. Explore the tabular format of the results. 5.4.6.1 Mesenchymal 5.4.6.2 Immunoreactive Link to information about GSEA results 5.5 Additional information More on GSEA data format More on processing the RNAseq using EdgeR and generate the .rank file More on which .gmt file to download from the Baderlab gene-set file, select current release, Human, symbol, Human_GOBP_AllPathways_no_GO_iea_….gmt More on GSEA : link to the Baderlab wiki page on GSEA "],
["module-3-network-visualization-and-analysis-with-cytoscape.html", "6 Module 3: Network Visualization and Analysis with Cytoscape", " 6 Module 3: Network Visualization and Analysis with Cytoscape Ruth Isserlin Lecture part 1 Lecture part 2 ## Module 3 Lab Veronique Voisin Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],
["gprofiler-mod3.html", "7 Module3: g:profiler Visualization 7.1 Goal of the exercise 7.2 Data 7.3 EnrichmentMap 7.4 Description of this exercise 7.5 Start the exercise 7.6 Exercise 1a 7.7 Step 1 7.8 Step 2 7.9 Step3: Explore the results: 7.10 Exercise 1b 7.11 Exercise 1c", " 7 Module3: g:profiler Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin, Ruth Isserlin, Gary Bader 7.1 Goal of the exercise Create an enrichment map and navigate through the network During this exercise, you will learn how to create an enrichment map from gene-set enrichment results. The enrichment results chosen for this exercise are generated using g:Profiler but an enrichment map can be created directly from output from GSEA or BinGo or alternately from any gene-set tool using the generic enrichment results format. 7.2 Data The data used in this exercise is a list of frequently mutated genes that we used in previous exercise. Pathway enrichment analysis has been run using g:Profiler and the results have been downloaded as a GEM format. 7.3 EnrichmentMap A circle (node) is a gene-set (pathway) enriched in genes that we used as input in g:Profiler (frequently mutated genes). edges (lines) represent genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process. Clicking on a node will display the genes included in each pathway. 7.4 Description of this exercise We run and saved g:Profiler results using different parameters. An enrichment map represents the result of enrichment analysis as a network where significantly enriched gene-sets that share a lot of genes in common will form identifiable clusters. The visualization of the results as these biological themes will ease the interpretation of the results. The goal of this exercise is to learn how to: 1. upload g:Profiler results into Cytoscape EnrichmentMap to create a map. 1. upload several g:Profiler results at the same time to create one map and learn how to distinguish the results. 1. to compare the differences resulting from the use of different g:Profiler parameters at the enrichment map level. 7.5 Start the exercise To start the lab practical section, first create a gprofiler_files directoty on your computer and download the files below. Five files are needed for this exercise (please download these files to your computer. Right click on the file name and save the file to a new directory): Enrichment result 1: gProfiler_hsapiens_GEM1.txt In g:Profiler, the parameters that we used were: GO_BP no electronic annotation, Reactome, Benjamini-HochBerg FDR 0.05. Enrichment result 2: gProfiler_hsapiens_gs250.gem.txt In g:Profiler, the parameters that we used were: GO_BP no electronic annotation, Reactome, Benjamini-HochBerg FDR 0.05. The results were filtered using the g:Profiler Term size slidebar and only the enriched gene-sets that contain equal or less than 250 genes per gene-set were included in the result file (gProfiler_hsapiens_gs250.gem.txt). Enrichment result 3: gProfiler_hsapiens_Baderlab_max250_gem.txt Pathway database 1 (.gmt):hsapiens_GO_REAC.gmt This file has been created by concatenating the hsapiens.GO/BP.name.gm and the hsapiens.REAC.name.gmt files contained in the g:Profiler gprofiler_hsapiens.name folder. Pathway database 2 (.gmt):Human_GOBP_AllPathways_no_GO_iea_June_20_2019_symbol_max250gssize.gmt 7.6 Exercise 1a 7.7 Step 1 Launch Cytoscape and open the EnrichmentMap App 1a. Double click on Cytoscape icon 1b. Open EnrichmentMap App In the Cytoscape top menu bar: Click on Apps -&gt; EnrichmentMap A ‘Create Enrichment Map’ window is now opened. 7.8 Step 2 Create an enrichment map from 2 datasets and with a gmt file. 2a. In the ‘Create Enrichment Map’ window, drag and drop the 2 enrichment files gProfiler_hsapiens_GEM1.txt and gProfiler_hsapiens_gs250.gem.txt. 2b. In the white box, click on “gProfiler_hsapiens_gs250.gem (Generic/gProfiler) 2c. On the right side, go to the GMT field, click on the 3 radio button (…) and locate the file hsapiens_GO_REAC.gmt that you have saved on your computer to upload it. 2d. In the white box, click on “gProfiler_hsapiens_GEM1 (Generic/gProfiler) 2e. On the right side, go to the GMT field, click on the 3 radio button (…) and locate the file hsapiens_GO_REAC.gmt that you have saved on your computer to upload it. 2f. Locate the FDR q-value cutoff field and set the value to 0.001 2g. Select the Connectivity slide bar to sparse. 2h. Click on Build. * a status bar should pop up showing progress of the Enrichment map build. 7.9 Step3: Explore the results: In the EnrichmentMap control panel located at the left: * select the 2 Data Sets (checked by default) * set Chart Data o Color by Data Set * select Publication Ready to remove gene-set label to have a global view of the map. un-select Publication Ready when you explore the map in more detail to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. * A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_GEM1 . * A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_GEM1. * A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_gs250.gem. We can see clusters of blue nodes. All these nodes contain gene-sets that have more than 250 genes. Explore the detailed view (see below) to see if this cluster corresponds to informative terms. :question: Would you have lost information by filtering gene-sets larger than 250 genes? 7.9.1 Explore Detailed results In the Cytoscape menu bar, select ‘View&quot; and ’Show Graphic Details’ to display node labels. :warning: Make sure you have unselected “Publication Ready” in the EnrichmentMap control panel. Zoom in to be able to read the labels and navigate the network using the bird eye view (blue rectangle). Select a node and visualize the Table Panel Click on a node For this example the node “Signaling by Notch” has been selected. you can type it in the search bar, quotes are important. When the node is selected, it is highlighted in yellow. In table panel, we can see the genes included in the gene-set. A green colored box indicates that the gene is in the gene-set(pathway) and in our gene list. A gray colored box indicated that the gene is in the gene-set but not in our gene list. 7.10 Exercise 1b Create an enrichment map without a gmt file to compare the results with Exercise 1a. Go to Control Panel and select the EnrichmentMap tab. Click on the “+” sign to re-open the Create Enrichment Map window. In the white box, select the “gProfiler_hsapiens_gs250.gem (Generic/gProfiler) file Locate the GMT field and delete the file name , leaving it blank. In the white box, select the “gProfiler_hsapiens_GEM1 (Generic/gProfiler) file Locate the GMT field and delete the file name , leaving it blank. Use same parameters as in exercise 1a: FDR q-value cutoff of 0.001 and Connectivity to sparse. Click on Build Explore the results: In the EnrichmentMap control panel located at the left: * select the 2 Data Sets (selecteded by default) * set Chart Data o Color by Data Set * select Publication Ready to remove gene-set label to have a global view of the map. uncheck this box when you explore the map in details to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. * A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_GEM1 . * A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_GEM1. * A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_gs250.gem. Conclusion of exercises 1 a and 1b: Loading a gmt file to create an enrichment map from g:Profiler result is optional. However, there are 2 main beneficial aspects to uploading a gmt file: 1. the map will be less condensed and easier to read and interpret. 1. clicking on a node will display all genes in the gene-set and not only genes included in our query list. 7.11 Exercise 1c Create an enrichment map from the results of g:Profiler generated using the custom Baderlab gene-set file. To get a map that is easy to read and that does not display too many gene-sets, one option is to focus the analysis on gene-sets (pathways) that contain 250 genes or less. We prefiltered our pathway database prior to upload it into g:Profiler so that FDR is calculated only on these gene-sets ( as opposed to exercise 1a where the FDR was calculated on all gene-sets and then some gene-sets &gt; 250 genes were excluded from the result file ). filtered gmt file: (Human_GOBP_AllPathways_no_GO_iea_June_24_2019_symbol_max250gssize.gmt). We have uploaded this file as a custom gmt file in g:Profiler and run the query. To create an enrichment map of these results: Go to Control Panel and select the EnrichmentMap tab. Click on the “+” sign to re-open the Create Enrichment Map window. In the white box, select the “gProfiler_hsapiens_Baderlab_max250_gem.txt (Generic/gProfiler) file Locate the GMT field and upload the file “Human_GOBP_AllPathways_no_GO_iea_June_24_2019_symbol_max250gssize.gmt”. Explore the results: SAVE YOUR CYTOSCAPE SESSION (.cys) FILE ! "],
["gsea-mod3.html", "8 Module3: GSEA Visualization 8.1 Goal of the exercise: 8.2 Data 8.3 GSEA output and EnrichmentMap 8.4 Start the exercise", " 8 Module3: GSEA Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin 8.1 Goal of the exercise: Create an enrichment map and navigate through the network During this exercise, you will learn how to create an EnrichmentMap from gene-set enrichment results. The enrichment tool chosen for this exercise is GSEA but an enrichment map can be created from various gene-set tools using the generic format or the more specific g:Profiler, DAVID or BiNGO formats. Post analysis (add drug target gene-sets to the network) As second part of the exercise, you will learn how to expand the network by adding an extra layer of information. Autoannotate A last optional exercise guides you toward the creation of automatically generated cluster labels to the network. 8.2 Data The data used in this exercise is gene expression data obtained from high throughput RNA sequencing. They correspond to Ovarian serous cystadenocarcinoma samples. We use precomputed results of the GSEA analysis [GSEA part] to create an enrichment map with the aim to transform the tabular format in a network to better visualize the relationships between the significant gene-sets: 8.3 GSEA output and EnrichmentMap The output results of GSEA are 2 tables: One table (pos) contains all pathways with an enrichment score (significant or not) related to enrichment of the mesenchymal category (positive score). One table (neg) contains all pathways with an enrichment score (significant or not) related to enrichment of the immunoreactive category (negative score). These 2 tables are uploaded using the EnrichmentMap App which will create a network of mesenchymal and immunoreactive pathways that have a significant score (FDR &lt;= 0.0001) for clearer visualization of the results. 8.3.1 EnrichmentMap A red circle (node) is a pathway specific of the mesenchymal type. A blue circle (node) is a pathway specific of the immunoreactive type. Green edges represent genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process. Clicking on a node will display the genes included in each pathway. 8.4 Start the exercise To start the lab practical section, first download the files. 7 Files are needed to create the enrichment map for this exercise (please download these files on your computer): GMT (file containing all pathways and corresponding genes) - Human_GOBP_AllPathways_no_GO_iea_December_24_2015_symbol.gmt Expression (file containing the RNAseq data for all samples and all genes) - MesenchymalvsImmunoreactive_rnaseq_expression.txt Enrichments 1 (GSEA results for the “pos” mesenchymal phenotype) - gsea_report_for_na_pos_1453222854028.xls Enrichments 1 (GSEA results for the “neg” immunoreactive phenotype) - gsea_report_for_na_neg_1453222854028.xls Rank file (file that has been used as input to GSEA) - MesenchymalvsImmunoreactive_edger_ranks.rnk Classes (define which samples are mesenchymal and which samples are immunoreactive) - MesenchymalvsImmunoreactive_rnaseq_classes.cls Drug target database (preselection of 4 drugs and their target genes u sed in the poast -analysis exercise, http://www.drugbank.ca/) - Human_DrugBank_approved_symbol_selected.gmt Follow the steps described below at your own pace: 8.4.1 Step 1 Launch Cytoscape and open EnrichmentMap App 1a. Double click on the Cytoscape icon 1b. Open EnrichmentMap App In the top menu bar: Click on Apps -&gt; EnrichmentMap A ’Create EnrichmentMap window is now opened. 8.4.2 Step 2 Create an enrichment map 2a. In the ‘Create EnrichmentMap’ window, add a dataset of the GSEA type by clicking on the ‘+’ plus sign. 2b. Specify the following parameters and upload the specified files: Name: leave default or a name of your choice like “GSEAmap” Analysis Type: GSEA Enrichments Pos: gsea_report_for_na_pos_1453222854028.xls Enrichments Ned: gsea_report_for_na_neg_1453222854028.xls GMT : Human_GOBP_AllPathways_no_GO_iea_December_24_2015_symbol.gmt Ranks: MesenchymalvsImmunoreactive_edger_ranks.rnk Expressions : MesenchymalvsImmunoreactive_rnaseq_expression.txt. this field is optional but recommended Classes: MesenchymalvsImmunoreactive_rnaseq_classes.cls this field is optional. Phenotypes: In the text boxes place Mesenchymal as the Positive phenotype Immunoreactive as the Negative phenotype. Mesenchymal will be associated with red nodes because it corresponds to the positive phenotype and Immunoreactive will be associated with the blue nodes because it corresponds to the negative phenotype. set FDR q-value cutoff to 0.0001 (= only gene-sets significantly enriched at a value of 0.0001 or less will be displayed on the map). it will be displayed as 1E-04 in the scientific notation. 2c. Click on Build We populated the fields manually. If you work with your own data, a way to populate automatically the fields is to drag and drop your GSEA folder in the ‘Data Set’ window. You are encouraged to give it a try once you finished the lab with your own GSEA results. Unformatted results: layout will be different for each user (there is a random seed in the layout algorithm) but it does not change the results or interpretation (the connections are the same, only the display is different). 8.4.3 Step 3 Navigate the enrichment map to gain a better understanding of a EnrichmentMap network. General layout of Cytoscape panel: In addition to the main window where the network is displayed, there are 2 panels: the Control Panel on the left side and the Table Panel at the bottom of the window. Steps: 3a. In the Cytocape menu bar, select View and * Show Graphic details*. It will turn the squared nodes into circles and the gene-set labels will be visible. 3b: Zoom in or out using + or - in toolbar or scroll button on mouse until you are able to read the labels comfortably. 3c: Use the bird’s eye view (located at the bottom of the control panel) to navigate around the network by moving the blue rectangle using the mouse or trackpad. 3d: Click on an individual node of interest. For this example, you could use Integrins signalling pathway. If you are unable to locate Integrins signalling pathway, type “Integrins signalling pathway” in the search box (quotes are important). Selected nodes appear yellow (or highlighted) in the network. 3e. In the Table Panel in the * EM Heat map* tab change: Expressions: “Row Norm* Compress: -None- Genes in the heatmap that are highlighted yellowm (rank column) represent genes part of the leading edge for this gene set, i.e. contributed the most to the enriched phenotype. Leading edge genes will only be highlighted if an individual node has been selected and the Enrichment Map was created from GSEA results. Troubleshooting: if you don’t see the sort column highlighted in yellow, reselect the node of interest and click on the GSEARanking Data Set 1 text in the EM Heatmap tab. 8.4.4 Step 4 Use Filters to automatically select nodes on the map: Move the blue nodes to the left side of the window and the red nodes to the right side of the window. 4a. Locate the Select tab from the Control Panel. 4b. Click on the + sign to view the menu and select Column Filter. 4c. From the Choose column … box, select Node: ES_dataset1 and set filter values from -0.953 and 0 inclusive. 4d. The blue nodes are now automatically selected. Zoom out to be able to look at the entire network and drag all blue nodes to the left side of the screen. 4e. Optional. Change is to is not to select the red nodes. Note: the red pathways (nodes) are specific of the mesenchymal phenotype. There were listed in the pos table of the GSEA results. The enrichment score (ES) in this table are all positive values. The blue pathways are specific of the immunoreactive phenotype and were listed in the neg table of the GSEA results. The ES in this table are all negative values. This information has been used to set the filtering criteria. 8.4.5 Step 5 Add drug target gene-sets to the network (Add Signature Gene-Sets…). 5a. In Control Panel, go to the EnrichmentMap tab and click on “Add Signature Gene Sets…” located below the white ‘Data Sets:’ window. A window named “EnrichmentMap: Add Signature Gene Sets (Post-Analysis) is now opened. 5b. Using the ‘Load from File…’ button, select the Human_DrugBank_approved_symbol_selected.gmt file that you saved on your computer. 5c. Click on “Finish”. Note: Four additional nodes are now added to the network and visible as grey diamonds. Dotted orange edges represent their overlap with the nodes of our network. These additional nodes represent gene targets of some approved drugs and these genes are either specific of the mesenchymal type (dotted orange edges connected to red nodes) or specific of the immunoreactive type (dotted orange edges connected to blue nodes). more info using this link: https://enrichmentmap.readthedocs.io/en/latest/PostAnalysis.html 8.4.6 Step 6 Auto-annotate the network with cluster labels. Important note 1: the Apps WordCloud, ClusterMaker and Autoannotate have to be installed. Important note 2: if you run step 5, delete the drug targets diamond nodes and associated edge before performing step 6: select the 4 nodes and associated dotted orange edges by browsing the mouse and click “delete” on your keyboard or in the Cytoscape menu, ‘Edit’, ‘Delete Selected Nodes and Edges’. 6a. In the menu bar, select Apps, AutoAnnotate, New Annotation Set …. An Autoannotate: Create Annotation Set window pops up. Leave default settings and click on Create Annotations. In the case that an AutoAnnotate window pops up with the message AutoAnnotate will manage all groups in this network view, click OK. The network is now subdivided into clusters that are represented by ellipses. Each of these clusters are composed of pathways (nodes) interconnected by many common genes. These pathways represent similar biological processes. The app WordCloud take all the labels of the pathways in one cluster and summarize them as a unique cluster label displayed at the top of each ellipse. Tip 1: further editing and formatting can be performed on the AutoAnnote results using the AutoAnnotate Display in the Results Panels located at the right side of the window. For example, it is possible to change Ellipse to Rectangle, uncheck Scale font by cluster size and increase the Font Scale using the scaling bar. It is also possible to reduce the length of the cluster label by checking the “Word Wrap” option. Tip 2: The AutoAnnotate window on the left side in Result Panel contains the list of all clusters. Clicking on a cluster label will highlight in yellow all nodes in this cluster. It is then easy to move the nodes using the mouse to avoid cluster overlaps. 6b. If your network is dense and clusters are overlapping, there is an option in AutoAnnotate that you can try that expands the network to prevent cluster overlap. In the menu bar, select Apps, AutoAnnotate, New Annotation Set …. An Autoannotate: Create Annotation Set window pops up. Check the Layout network to prevent cluster overlap and click on Create Annotations. 8.4.7 Step 7 Visualize genes in a pathway/node of interest using the apps STRING and GeneMANIA. This will create a protein-protein interaction network using the genes included in the pathway. Note: GeneMANIA theory and practical will be covered in next module. 7a: Click on an individual node of interest. For this example, you could use Integrins in angiogenesis. If you are unable to locate Integrins in angiogenesis, type “Integrins in angiogenesis” in the search box (quotes are important). The selected node appears yellow (or highlighted) in the network. If you have annotated your network, it should be included in the ecm receptor interaction cluster. 7b: Right Click on the node of interest to diplay the option menu. Select Apps, EnrichmentMap - Show in STRING A STRING Protein Query box appears. Unselect all genes Select None and select only the collagen genes with gene name starting with COL. Click on OK. 7c:Go back to enrichment map network. In Control Panel (left side of the window), select the “Network” tab and click on the Enrichment Map network as shown in below screenshot. 7d: Search again for the node labelled Integrins in angiogenesis as in Step 7a. Right Click on the node of interest to diplay the option menu. Select Apps, EnrichmentMap - Show in GeneMANIA. A GeneMANIA Query box appears. Unselect all genes Select None and select only the collagen genes with gene name starting with COL. Click on OK. It is possible to view gene expression data for the nodes in the STRING network. See the section https://enrichmentmap.readthedocs.io/en/latest/Integration.html and try it out after the workshop. SAVE YOUR FILE! "]
]
